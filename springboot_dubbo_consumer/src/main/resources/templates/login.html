<!DOCTYPE html>
<!--[if IE 8 ]><html class="ie" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US"><!--<![endif]-->
<head>
	<!-- Basic Page Needs -->
	<meta charset="UTF-8">
	<!--[if IE]><meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'><![endif]-->
	<title>Techno Store - My Account</title>

	<meta name="author" content="CreativeLayers">

	<!-- Mobile Specific Metas -->
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<!-- Boostrap style -->
	<link rel="stylesheet" type="text/css" href="/stylesheets/bootstrap.min.css">

	<!-- Theme style -->
	<link rel="stylesheet" type="text/css" href="/stylesheets/style.css">

	<!-- Reponsive -->
	<link rel="stylesheet" type="text/css" href="/stylesheets/responsive.css">

	<style>
		body {
			background: url(/favicon/log.png);
			background-position: center center;
			background-repeat: no-repeat;
			background-attachment: fixed;
			background-size: cover;
		}
	</style>
</head>
<body class="row bg">

<!-- Javascript -->
<script type="text/javascript" src="/javascript2/jquery.min.js"></script>
<script type="text/javascript" src="/javascript2/tether.min.js"></script>
<script type="text/javascript" src="/javascript2/bootstrap.min.js"></script>
<script type="text/javascript" src="/javascript2/waypoints.min.js"></script>
<script type="text/javascript" src="/javascript2/jquery.circlechart.js"></script>
<script type="text/javascript" src="/javascript2/easing.js"></script>
<script type="text/javascript" src="/javascript2/jquery.flexslider-min.js"></script>
<script type="text/javascript" src="/javascript2/owl.carousel.js"></script>
<script type="text/javascript" src="/javascript2/smoothscroll.js"></script>
<script type="text/javascript" src="/javascript2/jquery-ui.js"></script>
<script type="text/javascript" src="/javascript2/jquery.mCustomScrollbar.js"></script>
<script type="text/javascript" src="http://ditu.google.cn/maps/api/js?key=AIzaSyBtRmXKclfDp20TvfQnpgXSDPjut14x5wk&region=GB"></script>
<script type="text/javascript" src="/javascript2/gmap3.min.js"></script>
<script type="text/javascript" src="/javascript2/waves.min.js"></script>
<script type="text/javascript" src="/javascript2/jquery.countdown.js"></script>
<script type="text/javascript" src="/javascript2/main.js"></script>
<!--bootstarp弹框-->
<script type="text/javascript" src="/bootstrap-bootbox/bootbox.js"></script>


<script src="../jquery.cookie.js"></script>

<div class="container" style="margin-top: 50px">
	<div class="row" id="loginDiv">
		<div class="col-md-6">
			<!--这个容器市居右-->
		</div><!-- /.col-md-6 -->
		<div class="col-md-6">
			<div class="form-login">
				<div class="title">
					<h3>登录</h3>
				</div>
				<form id="loginForm" accept-charset="utf-8">
					<div class="form-box">
						<label for="name-login">手机号或邮箱</label>
						<input type="text" id="name-login" name="cmsUserName" placeholder="Ali">
					</div><!-- /.form-box -->
					<div class="form-box">
						<label for="password-login">密码 </label>
						<input type="password" id="password-login" name="cmsUserPwd" placeholder="******">
					</div><!-- /.form-box -->
					<div class="form-box">
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						<button type="button" onclick="loginCmsUser()" class="login">登录</button>
					</div><!-- /.form-box -->
					<div class="form-box checkbox">
						<a href="javascript:forgetPassword()" title="">忘记密码？</a>
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						<a href="javascript:register()" title="">注册</a>
					</div><!-- /.form-box -->
				</form><!-- /#form-login -->
			</div><!-- /.form-login -->
		</div><!-- /.col-md-6 -->
	</div><!-- /.row -->
	<div class="row" id="registerDiv">
		<div class="col-md-6">
			<!--这个容器市居右-->
		</div><!-- /.col-md-6 -->
		<div class="col-md-6">
			<div class="form-login">
				<h3>注册</h3>
				<form id="registerForm" accept-charset="utf-8">
					<div class="form-box">
						<label for="name-login">手机号或邮箱</label>
						<input type="text" id="name-register" name="cmsUserName" placeholder="手机号或邮箱" onblur="yzName()">
						<span id="nameId"></span>
					</div><!-- /.form-box -->
					<div class="form-box">
						<label for="password-login">密码 </label>
						<input type="password" id="password-register" name="cmsUserPwd" placeholder="******" onblur="yzPwd()" maxlength=16>
						<span id="pwdId"></span>
					</div><!-- /.form-box -->

					<div class="form-box">
						<label for="Phone-register">手机号</label>
						<input type="text" id="Phone-register" name="cmsUserPhone" placeholder="请按此格式输入：133****2253" onblur="yzPhone()">
						<span id="phoneId"></span>
					</div><!-- /.form-box -->

					<div class="form-inline">
						<label for="password-register" class="col-sm-2 control-label">验证码</label>
						<div class="col-sm-4">
							<input type="text" class="form-control" id="security-register" onblur="yzyzm()" size="8px">
							<span id="securityId"></span>
						</div>
						<input class="btn btn-default" onclick="sendPhoneCode()" type="button" id="codeId" size="5px" value="发送验证码">
					</div><!-- /.form-box -->

					<div class="form-box">
						<button type="button" class="login" onclick="registerVerify()">注册</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						<a href="../to/cmsLogin">登录</a>
					</div><!-- /.form-box -->
				</form><!-- /#form-login -->
			</div><!-- /.form-login -->
		</div><!-- /.col-md-6 -->
	</div><!-- /.row -->
</div><!-- /.container -->

<script>
	$(function(){
		$("#registerDiv").hide()
		if ($.cookie("rmbUser") == "true") {
			$("#rememberMe").attr("checked", true);
			$("#NameText").val($.cookie("username"));
			$("#inputPassword").val($.cookie("password"));
		}
	})

	function loginCmsUser() {
		$.ajax({
			url:"../user/loginCms",
			type:"post",
			data:$("#loginForm").serialize(),
			success:function (data) {
				if(data==1){
					location.href="/to/index";
				}else if (data==2){
					bootbox.alert({
						size: "small",
						title: "提示",
						message: "密码不正确"
					})
				}else{
					bootbox.alert({
						size: "small",
						title: "提示",
						message: "用户不存在"
					})
				}
			}
		})
	}
	function register(){
		$("#loginDiv").hide();
		$("#registerDiv").show();
	}

	/*	var yzm='';
        function resendSecurity(){
            if(yzPhone()){
                $.ajax({
                    url:"../user/noteHint",
                    type:"post",
                    async:false,
                    data:{'cmsPhone':$("#Phone-register").val()},
                    success:function(data){
                        yzm=data;
                    }
                })
            }
            return yzm;
        }*/

	function  yzName(){
		var regiserCmsName=$("#name-register").val();
		var re=/^\w+@[a-z0-9]+\.[a-z]{2,4}$/
		var reg=/^1[0-9]{10}$/;
		if(reg.test(regiserCmsName)||re.test(regiserCmsName)){
			$("#nameId").html("")
			return true;
		}
		$("#nameId").html("用户名不符合规则")
		return false;
	}

	function yzPwd() {
		var pwd=$("#password-register").val();
		var reg=/^[0-9a-zA-Z]{8,16}$/;
		if(reg.test(pwd)){
			$("#pwdId").html("")
			return true;
		}
		$("#pwdId").html("密码强度太低")
		return false;
	}





	function yzPhone(){
		var phone=$("#Phone-register").val();
		var reg=/^1[0-9]{10}$/;
		if(reg.test(phone)){
			$("#phoneId").html("")
			return true;
		}
		$("#phoneId").html("电话格式不对")
		return false;
	}

	function  yzyzm(){

		var yz=$("#security-register").val();
		alert(yzm+""+yz)
		if(yz==yzm){
			$("#securityId").html("")
			return true;
		}
		$("#securityId").html("验证码不正确")
		return false;
	}
	function registerVerify() {
		alert($("#registerForm").serialize())
		if(yzName()&yzPhone()&yzPwd()&yzyzm()){
			$.ajax({
				url:"../user/registerCmsUser",
				type:"post",
				data:$("#registerForm").serialize(),
				success:function(data){
					bootbox.alert({
						size: "small",
						title: "提示",
						message: "注册成功请登录"
					})
					location.href="../to/cmsLogin";
				}
			})
		}
	}

	var InterValObj; //timer变量，控制时间
	var count = 60; //间隔函数，1秒执行
	var curCount;//当前剩余秒数
	//发送手机验证码
	var yzm='';
	function sendPhoneCode(){
		if(!yzPhone()){
			bootbox.alert({
				size: "modal-lg",
				title: "提示",
				message: "请输入正确的手机号"
			})
			return ;
		}
		curCount = count;
		//设置button效果，开始计时
		//$("#btnSendCode").attr("disabled", "true");
		$("#codeId").val(curCount + "秒后重新发送");
		$("#codeId").removeAttr("onclick");
		InterValObj = window.setInterval(SetRemainTime, 1000); //启动计时器，1秒执行一次
		$.ajax({
			url:"../user/noteHint",
			type:"post",
			async:true,
			data:{'cmsPhone':$("#Phone-register").val()},
			success:function(data){
				yzm=data;
			}
		})
		return yzm;
	}
	//timer处理函数
	function SetRemainTime() {
		if (curCount == 1) {
			window.clearInterval(InterValObj);//停止计时器
			//$("#btnSendCode").removeAttr("disabled");//启用按钮
			$("#codeId").attr("onclick","sendPhoneCode();");
			$("#codeId").val("免费获取");
		}
		else {
			curCount--;
			$("#codeId").val(curCount + "秒后重新发送");
		}
	}
	//记住密码 用不了
	/*function save() {
		alert(1)
		if ($("#remember").prop("checked")) {
			alert(2)
			var str_username = $("#name-login").val();//用户名
			var str_password = $("#password-login").val();//密码
			$.cookie("rmbUser", "true", { expires: 7 }); //存储一个带7天期限的cookie
			$.cookie("username", str_username, { expires: 7 });
			$.cookie("password", str_password, { expires: 7 });
		}
		else {
			$.cookie("rmbUser", "false", { expire: -1 });
			$.cookie("username", "", { expires: -1 });
			$.cookie("password", "", { expires: -1 });
		}
	};*/
	//忘记密码
	function forgetPassword(){
		if($("#name-login").val()!=""){
			$.ajax({
				url:"../user/queryCmsUserName",
				type:"post",
				data:{cmsUserName:$("#name-login").val()},
				success:function (data) {
					if(data!=1){
						bootbox.alert({
							size: "modal-lg",
							title: "提示",
							message: "该用户不存在，请注册"
						})
						return  ;
					}
					location.href="../user/forgetPwd?cmsUserName="+$("#name-login").val();
				}
			})

		}else{
			bootbox.alert({
				size: "modal-lg",
				title: "提示",
				message: "请输入用户名"
			})
		}

	}

	var res;
	function createAddContent(url){     //弹框通过这个返回整个页面对象
		$.ajax({
			url:url,
			async:false,
			success:function(data){
				res = data;
			}
		});
		return res;
	}
</script>

</body>
</html>